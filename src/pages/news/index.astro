---
export const prerender = false
import Base from '../../layouts/Base.astro'
import { client } from '../../lib/sanity'
import SanityImage from '../../components/SanityImage.astro'
import { NEWS_LIST } from '../../lib/queries'

const posts = await client.fetch(NEWS_LIST)
---
<Base title="News – Repair Café Leonberg">
  <h1 class="pt-12 text-3xl font-bold text-slate-100">News</h1>
  <ul class="mt-6 grid gap-6 sm:grid-cols-2 lg:grid-cols-3">
    {(posts ?? []).map((p: any) => (
      <li class="rounded-2xl border border-slate-700 bg-slate-800/50 p-5 shadow-soft hover:shadow-lg transition">
        <a href={`/news/${p.slug?.current ?? ''}`} class="block">
          {p.cover && (
            <SanityImage image={p.cover} alt={p.title} width={800} height={450} sizes="(min-width: 1024px) 33vw, (min-width: 640px) 50vw, 100vw" class="mb-3 w-full aspect-[16/9] rounded-md object-cover" />
          )}
          <h2 class="text-lg font-semibold text-slate-100">{p.title}</h2>
          <p class="mt-1 text-sm text-slate-400">{new Date(p.date ?? p.publishedAt).toLocaleDateString('de-DE')}</p>
          {p.excerpt && <p class="mt-2 text-sm text-slate-300 line-clamp-3">{p.excerpt}</p>}
        </a>
      </li>
    ))}
  </ul>
</Base>
