---
export const prerender = false
import Base from '../../layouts/Base.astro'
import { client } from '../../lib/sanity'
import SanityImage from '../../components/SanityImage.astro'
import { formatDateTime } from '../../lib/date'
import { EVENTS_PAGE } from '../../lib/queries'

const { upcoming = [], past = [] } = await client.fetch(EVENTS_PAGE) ?? {}
---
<Base title="Termine – Repair Café Leonberg">
  <h1 class="pt-12 text-3xl font-bold text-slate-100">Termine</h1>

  <h2 class="mt-8 text-xl font-semibold text-brand-400">Kommende Termine</h2>
  <ul class="mt-4 grid gap-6 sm:grid-cols-2">
    {upcoming.map((e: any) => (
      <li class="rounded-2xl border border-slate-700 bg-slate-800/50 p-5 shadow-soft hover:shadow-lg transition">
        <a href={`/events/${e.slug?.current ?? ''}`} class="block">
          <h3 class="text-lg font-semibold text-slate-100">{e.title}</h3>
          <p class="text-sm text-slate-300">{formatDateTime(e.start)}{e.location ? ` · ${e.location}` : ''}</p>
          {e.hero && (
            <SanityImage image={e.hero} alt={e.title} width={800} height={450} sizes="(min-width: 1024px) 50vw, (min-width: 640px) 50vw, 100vw" class="mt-3 w-full aspect-[16/9] rounded-md object-cover" />
          )}
        </a>
      </li>
    ))}
  </ul>

  <h2 class="mt-12 text-xl font-semibold text-slate-100">Vergangene Termine</h2>
  <ul class="mt-4 space-y-4">
    {past.map((e: any) => (
      <li class="border-b border-slate-700 pb-4">
        <a class="font-medium hover:underline text-slate-200" href={`/events/${e.slug?.current ?? ''}`}>{e.title}</a>
        <span class="ml-2 text-sm text-slate-400">{new Date(e.start).toLocaleDateString('de-DE')}</span>
      </li>
    ))}
  </ul>
</Base>
